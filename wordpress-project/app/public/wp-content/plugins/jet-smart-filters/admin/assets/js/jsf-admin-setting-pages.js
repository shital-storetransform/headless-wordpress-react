"use strict";function debounce(e,t,s=!1){let r=null;return function(){const i=s&&!r,a=()=>e.apply(this,arguments);clearTimeout(r),r=setTimeout(a,t),i&&a()}}function clone(e){if("object"!=typeof e)return e;let t,s,r;t=Array.isArray(e)?[]:{};for(r in e)s=e[r],t[r]="object"==typeof s?clone(s):s;return t}function copyToClipboard(e,t=(()=>{}),s=(()=>{})){navigator.clipboard.writeText(e).then(function(){t(e)},function(e){s(e)})}const jetSmartFiltersSettinsMixin={data:function(){return{data:window.jetSmartFiltersSettingsConfig.data,settings:window.jetSmartFiltersSettingsConfig.settings,preparedOptions:{},savingStatus:!1,ajaxSaveHandler:null,repeaterItemCollapsed:!0}},watch:{settings:{handler(e){const t={};for(const s in e)t[s]=e[s];this.preparedOptions=t,this.saveOptions()},deep:!0}},computed:{directUrl(){return this.urlAliasesTransform(this.url)}},mounted:function(){this.repeaterItemCollapsed=!1},methods:{saveOptions:debounce(function(){this.ajaxSaveSettings({settings:this.preparedOptions})},300),ajaxSaveSettings(e,t=(()=>{})){var s=this;s.savingStatus=!0,s.ajaxSaveHandler=jQuery.ajax({type:"POST",url:window.jetSmartFiltersSettingsConfig.settingsApiUrl,dataType:"json",data:e,beforeSend:function(e,t){e.setRequestHeader("X-WP-Nonce",window.jetSmartFiltersSettingsConfig.nonce),null!==s.ajaxSaveHandler&&s.ajaxSaveHandler.abort()},success:function(e,r,i){s.savingStatus=!1,"success"===e.status&&(s.$CXNotice.add({message:e.message,type:"success",duration:3e3}),t("success")),"error"===e.status&&(s.$CXNotice.add({message:e.message,type:"error",duration:3e3}),t("error"))}})},repeaterAddItem:function(e,t){t.push(e)},repeaterCloneItem:function(e,t){t.splice(e+1,0,clone(t[e]))},repeaterDeleteItem:function(e,t){t.splice(e,1)},updateAlias(e,t,s){const r=this.settings.url_aliases[t];r&&r[s]!==e&&(r[s]=e)},onAliasInputEvent(e,t,s){("keypress"===e.type&&13===e.keyCode||"blur"===e.type)&&this.updateAlias(e.target.value,t,s)},updateProviderPreloaderCSS(){const{use_bg:e,size:t,color:s,border_radius:r,bg_color:i,padding:a}=this.settings.provider_preloader_styles;let n=".jsf_provider-preloader{";n+=`font-size:${t}px;`,n+=`color:${s};`,e&&(n+=`border-radius:${r}px;`,n+=`background:${i};`,n+=`padding:${a.top}px ${a.right}px ${a.bottom}px ${a.left}px;`,n+="box-shadow:1px 2px 8px rgba(35,40,45,.2);"),n+="}",this.settings.provider_preloader_css=n},changeProviderPreloaderTemplate(e){const t=jQuery(".provider-preloader-preview__container");t.addClass("provider-preloader-template-loading"),jQuery.ajax({url:window.jetSmartFiltersSettingsConfig.ajaxurl,type:"POST",dataType:"json",data:{action:"jet_smart_filters_get_provider_preloader_template",type:e}}).done(e=>{const s=e.data;s&&s.template&&(t.removeClass("provider-preloader-template-loading"),t.html(s.template))})}}},seoSitemapFiltersOptions=clone(window.jetSmartFiltersSettingsConfig.data.seo_sitemap_filters_options),seoRulesSettinsMixin={data:function(){return{seoSitemapRulesSettings:this.getRulesSettings(),seoSitemapRulesSaving:!1,xmlPath:window.jetSmartFiltersSettingsConfig.data.seo_sitemap_xml_path,xmlUrl:window.jetSmartFiltersSettingsConfig.data.seo_sitemap_xml_url,copyXmlUrlClass:""}},methods:{getRulesSettings(){const e=clone(window.jetSmartFiltersSettingsConfig.settings.seo_sitemap_rules)||[];return e.forEach(e=>{e.hasOwnProperty("url")||(e.url=""),e.hasOwnProperty("provider")||(e.provider=""),e.hasOwnProperty("query_id")||(e.url=""),e.hasOwnProperty("filters")&&Array.isArray(e.filters)||(e.filters=[])}),e},getRuleTitle(e){const t=this.seoSitemapRulesSettings[e];let s="URL: ";return s+=t.url?"<strong>"+t.url+"</strong>":"<i>empty</i>",s+=" â€” ",s+="Provide: ",t.provider?(s+="<strong>"+t.provider,t.query_id&&(s+=":"+t.query_id),s+="</strong>"):s+="<i>empty</i>",s},getAllowedFiltersOptions(e,t){let s=[...seoSitemapFiltersOptions];const r=this.seoSitemapRulesSettings[e];if(!r.filters.length)return s;const i=[...r.filters];return i.splice(t,1),s.filter(e=>!i.includes(e.value))},saveRules(){this.seoSitemapRulesSaving=!0,this.ajaxSaveSettings({key:"seo_sitemap_rules",settings:this.seoSitemapRulesSettings},e=>{this.seoSitemapRulesSaving=!1})},copyXmlUrl(){copyToClipboard(this.xmlUrl,()=>{this.copyXmlUrlClass="seo-sitemap-rules-xml-path-copy-success"},()=>{this.copyXmlUrlClass="seo-sitemap-rules-xml-path-copy-error"}),setTimeout(()=>{this.copyXmlUrlClass=""},1e3)}}};Vue.component("jet-smart-filters-general-settings",{template:"#jet-dashboard-jet-smart-filters-general-settings",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jet-smart-filters-indexer-settings",{template:"#jet-dashboard-jet-smart-filters-indexer-settings",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jet-smart-filters-url-structure-settings",{template:"#jet-dashboard-jet-smart-filters-url-structure-settings",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jet-smart-filters-seo-rules-settings",{template:"#jet-dashboard-jet-smart-filters-seo-rules-settings",mixins:[jetSmartFiltersSettinsMixin,seoRulesSettinsMixin]}),Vue.component("jet-smart-filters-seo-rules-settings",{template:"#jet-dashboard-jet-smart-filters-seo-rules-settings",mixins:[jetSmartFiltersSettinsMixin,seoRulesSettinsMixin]}),Vue.component("jet-smart-filters-ajax-request-settings",{template:"#jet-dashboard-jet-smart-filters-ajax-request-settings",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jet-smart-filters-provider-preloader",{template:"#jet-dashboard-jet-smart-filters-provider-preloader",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jet-smart-filters-accessibility-settings",{template:"#jet-dashboard-jet-smart-filters-accessibility-settings",mixins:[jetSmartFiltersSettinsMixin]}),Vue.component("jsf-repeater",{template:"#jet-smart-filters-repeater",props:{value:{type:Array,default:()=>[]},label:{type:String,default:""},actionsEnabled:{type:Boolean,default:!0},addText:{type:String,default:"Add"},defaultItem:{default:null}},methods:{onAddItemClick(){null!==this.defaultItem&&this.value.push(this.defaultItem),this.$emit("add-item")},onRemoveItemClick(e){this.value.splice(e,1),this.$emit("delete-item",e)}}}),Vue.component("jsf-url-aliases-example",{template:"#jet-smart-filters-url-aliases-example",props:{value:{type:String,default:""},aliases:{type:Array,default:()=>[]},urlPrefix:{type:String,default:"http://demo.org/"},defaultUrl:{type:String,default:""}},data:function(){return{url:this.value,directOpened:!1,reverseOpened:!1,isUrlEdite:!1}},computed:{directUrl(){return this.urlAliasesTransform(this.url)},reverseUrl(){return this.urlAliasesTransform(this.directUrl,!0)},directTransformations(){return this.urlAliasesTransformations(this.url)},reverseTransformations(){return this.urlAliasesTransformations(this.directUrl,!0)},isUrl(){return!!this.url&&/[\/|\?|\&]jsf[\/|=]/.test(this.url)},isNotDefaultUrl(){return this.defaultUrl&&this.url!==this.defaultUrl},isMatches(){return this.directTransformations.length>0||this.reverseTransformations.length>0}},watch:{value(e){this.url=e}},methods:{urlAliasesTransformations(e,t=!1){const s=[];let r=e,i=0;return this.aliases.forEach(a=>{if(i++,!a.needle||!a.replacement)return;const n=e.indexOf(t?a.replacement:a.needle);if(n>-1){const l=n+(t?a.needle.length:a.replacement.length);e=t?e.replace(a.replacement,a.needle):e.replace(a.needle,a.replacement),r=e.slice(0,n)+'<span class="highlight">'+e.slice(n,l)+"</span>"+e.slice(l),s.push({url:e,html:r,replacement:{from:t?a.replacement:a.needle,to:t?a.needle:a.replacement},index:i})}}),s},urlAliasesTransform(e,t=!1){return this.aliases.forEach(s=>{s.needle&&s.replacement&&(e=t?e.replace(s.replacement,s.needle):e.replace(s.needle,s.replacement))}),e},onUrlInput(e){},onUrlEditClick(){this.isUrlEdite=!0,this.$nextTick(()=>this.$refs.urlInput.focus())},onUrlEditRestoreClick(){this.isNotDefaultUrl&&this.$emit("input",this.defaultUrl)},onUrlEditConfirmClick(){const e=jQuery(this.$el).find(".url-aliases-example-string-editor-input").val();e!==this.value&&this.$emit("input",e),this.isUrlEdite=!1},onUrlEditCancelClick(){this.url=this.value,this.isUrlEdite=!1},onDirectClick(){this.directOpened=!this.directOpened},onReverseClick(){this.reverseOpened=!this.reverseOpened}}}),Vue.component("v-style",{render:function(e){return e("style",this.$slots.default)}});